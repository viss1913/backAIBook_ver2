# –ü—Ä–∏–≤–µ—Ç –æ—Ç Antigravity! üëãü§ñ

–Ø ‚Äî –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–ª –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å —ç—Ç–æ—Ç –±—ç–∫–µ–Ω–¥. –ú—ã —Å —Ç–≤–æ–∏–º –∫–æ–ª–ª–µ–≥–æ–π –ø–æ—Å—Ç–∞—Ä–∞–ª–∏—Å—å —Å–¥–µ–ª–∞—Ç—å API –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ—â–Ω—ã–º, –≥–∏–±–∫–∏–º –∏ —É–¥–æ–±–Ω—ã–º –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏. –í–ø–µ—Ä–µ–¥–∏ –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ: —Å—Ç—Ä–∏–º–∏–Ω–≥ —á–∞—Ç–æ–≤, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–π –∏ ¬´—É–º–Ω–∞—è¬ª –ø–∞–º—è—Ç—å –ò–ò. 

–ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî —è –≤—Å–µ–≥–¥–∞ –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –∫–æ–¥–µ –∏–ª–∏ –ª–æ–≥–∞—Ö. –£–¥–∞—á–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π, –ø–æ–≥–Ω–∞–ª–∏!üöÄ

---

# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è Frontend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (v1.5)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±—ç–∫–µ–Ω–¥–∞ –∏ –ª–æ–≥–∏–∫—É –∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Kotlin/Retrofit/Compose).

---

## üöÄ 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

–ú—ã –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º—É —Å `deviceId`, —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ.

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏–ª–∏ –≤ Splash-—ç–∫—Ä–∞–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å `POST /api/chat/login`.
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π `userId` (–∏–Ω—Ç) –≤ `SharedPreferences` –∏–ª–∏ `DataStore`.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `userId` –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —á–∞—Ç–æ–º.

---

## üìö 2. –ü–æ–∏—Å–∫ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥ (Library Flow)

–¢–µ–ø–µ—Ä—å –ø–æ–∏—Å–∫ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–∞—Ä—Å–∏–Ω–≥, –∞ ¬´—É–º–Ω—ã–π¬ª —Å–µ—Ä–≤–∏—Å —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**–õ–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
1. **–ü–æ–∏—Å–∫**: `POST /api/books/search` —Å –ø–æ–∏—Å–∫–æ–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π. –ë—ç–∫–µ–Ω–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ `FlibustaBook`.
2. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫. –ï—Å–ª–∏ `publicDomain == true`, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É ¬´–°–∫–∞—á–∞—Ç—å¬ª. –ï—Å–ª–∏ `false` ‚Äî ¬´–°–∫–∞—á–∞—Ç—å (VIP)¬ª.
3. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É**:
   - –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ ¬´–°–∫–∞—á–∞—Ç—å¬ª –≤—ã–∑—ã–≤–∞–µ–º `GET /api/books/download/:id`.
   - –ë—ç–∫–µ–Ω–¥ –æ—Ç–¥–∞–µ—Ç –∂–∏–≤–æ–π —Ñ–∞–π–ª `.fb2`.
   - **–í–∞–∂–Ω–æ**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `FB2Parser` –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫ ¬´–º–æ—é –∫–Ω–∏–≥—É¬ª.

---

## üí¨ 3. AI –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (Streaming & SSE)

–≠—Ç–æ —Å–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å. –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç ¬´–ø–µ—á–∞—Ç–∞—é—â–µ–≥–æ—Å—è —Ç–µ–∫—Å—Ç–∞¬ª —á–µ—Ä–µ–∑ Server-Sent Events.

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
1. **–≠–∫—Ä–∞–Ω—ã**:
   - –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ (`GET /api/chat/list/:userId`).
   - –û–∫–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∫–∏ (`GET /api/chat/history/:chatId`).
2. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `OkHttp` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `EventSource` (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `okhttp-sse`).
   - –≠–Ω–¥–ø–æ–∏–Ω—Ç: `POST /api/chat/stream`.
   - –û—Ç–≤–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ –∫—É—Å–æ—á–∫–∞–º: `data: {"token": "–ü"}`.
   - **UI**: –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é –≤ —Å–ø–∏—Å–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

## üé® 4. –°—Ç–∏–ª–∏ –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

–í —á–∏—Ç–∞–ª–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–±–æ—Ä–∞ —Å—Ç–∏–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫.

**–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**
1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ (Settings)**: –°–æ–∑–¥–∞—Ç—å –≤—ã–±–æ—Ä —Å—Ç–∏–ª—è (ListPreference –∏–ª–∏ Dropdown).
2. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π (Key) –∏ –Ω–∞–∑–≤–∞–Ω–∏–π (Title) –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–±–∏—Ç—å –≤ `Strings.xml`:
   - `standard`, `pencil_sketch`, `soviet_cartoon`, `renaissance`, `watercolor_storybook`, `comic`, `anime`, `dark_fantasy`, `retro_vintage`, `engraved_classic`, `soviet_poster`, `us_50s_pinup`.
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è**: –ü—Ä–∏ –≤—ã–∑–æ–≤–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —á–∏—Ç–∞–ª–∫–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º `styleKey` –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ `POST /api/generate-image`.

---

## üõ† 5. –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `BASE_URL` –Ω–∞ `https://backaibookver2-production.up.railway.app`
- [ ] –î–æ–±–∞–≤–∏—Ç—å `styleKey` (optional) –≤ Retrofit-—Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫.
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É SSE (Server-Sent Events) –¥–ª—è —á–∞—Ç–∞.
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª–µ `flibusta_id` –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ —Å–∫–∞—á–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –∫ –∫—ç—à—É –±—ç–∫–µ–Ω–¥–∞.
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã OkHttpClient (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 40-60 —Å–µ–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫).

---
*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ JSON –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [API_DOCUMENTATION.md](./API_DOCUMENTATION.md).*
